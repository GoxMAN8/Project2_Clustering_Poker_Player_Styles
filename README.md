# Project2_Clustering_Poker_Player_Styles

Project part of the module INM433, Visual Analytics, City University, London. Synthesis of a full report.

# Motivation

The motivation this paper comes from authors’ opinion that any solution to games with imperfect information3 could be further improved 
via human/machine interaction. The value of clustering poker player styles, in both: computational poker agent modeling 
as well as real time human decision making. (North, 2009) (Harrington and Robertie, 2004) 
The lack of comprehensive studies on POT-LIMIT Texas Hold’em variation.

Harrington (Harrington and Robertie, 2004) suggested that any poker hand in any given session 
could be described by ten variables. Two out of ten can never be objectively observed and measured:
opponent cards and opponent style. It is argued that by accurately describing opponent style, 
opponent cards could be deduced from remaining variables. Borer (Borer 2007) popularized three measures. to categorize players into 4 clusters. 
Measures are AF, VPIP and PFR (Appendix A). Clusters: loose-passive, loose-aggressive; tight-passive; tight-aggressive. 
However, nowadays as a result of huge increase in data and availability of various measures, the significance of these variables is arguable.

Main goal of this paper is to evaluate and expand on Borers’ variables, in poker player style clustering. Secondary one, is to deduce the 
characteristics of a winning poker player.

# Workflow

1. Data gathering.

Data was taken from famous University of Alberta poker research group website.( http://poker.cs.ualberta.ca/irc_poker_database.html; Python)
It was generated by players competing for fake money over internet relay chat (IRC) channel. 
Participants were known to be mostly computer science geeks and poker enthusiasts. 
As a result, overall quality of information is considered to be quite good and applicable to recent times. 
There are 1 826 766 POT-LIMIT Hold’em hands, played between 1995 and 2001 in total. Data is contained in 4892 files, 
unique for each player and describing the universe of actions performed, along with outcomes.

2. Data preprocessing

Main task in preprocessing was to derive unique player characteristics and to reduce data-frame where every row is unique player, 
instead of hand. Borers’ variables had been derived according to (Borer 2007),  using regular expressions in python.
Three extra variables were created by the author. DECEPT, defining proportion of times aggressive action followed passive, or vice versa 
pre-flop. (deceptiveness pre-flop) COMMPROP, defining the average proportion of the bankroll committed to pot pre-flop. 
WTSHWD, defining proportion of hands, player commited money pre-flop and went until showdown. (last stage of a hand)

3. Unsupervised clustering. (Brorer variables)

K-means7 was used to cluster players according to specified characteristics.
It calculates Euclidean distances; and adjusts centroids iteratively to find data clusters in high dimensional space, 
is also robust and fast. Results for different combinations of variables had been evaluated using Silhouette coefficient; 
Calinski-Harabaz score; for full model optimal number of variables derived from Silhouette plot. 
Results are exported to Tableau for further analysis using parallel coordinate maps (PCM) and distribution histograms. 
Averages are taken in PCM to reduce clutter; one coordinate – proportion of winning players added next to characteristics for 
immediate view on profitability of different styles. Frequency histograms, in which every bar divided in four clusters, 
depicts distribution of profitability for different styles of poker player. Welch t-tests are performed to test the significance of 
differences in mean profitability, 
as a result of violation of ANOVA assumptions and Welch –test superiority. (Mooser and Stevens, 1992)

4. Supervised learning. (Winning characteristics)

The visual methods applied are very abstract and would not uncover non-linear complex relationships, therefore implementation of Random Forrest algorithm follows. 
(Breinman 2001) Main reason for choosing this particular method, is its robustness and predictive power. (Caruana et.al, 2006) 
However, algorithm requires some tuning and adjustment for results of a model converge to cross-validated result. 
Classifier is evaluated using various visual techniques – out-of bag error plots - to find optimal number of decision trees; learning curves – to investigate the algorithms ability to learn with additional data; 
ROC-AUC curves and confusion matrices to picture the performance. Feature contributions had been extracted using treeinterpeter. (Saabas 2014) 
Contributions compared to implicit measure - GINI10 impurity decrease. Treeinterpreter gives linear sum of feature contributions; while GINI is more versatile measure. 
Results are exported back to Tableau, where visually analyzed by graphing contributions,
importances against probability of a winning class.

5. Analysis of results/report writing.

Results analyzed, 9 page report written

# Conclusion

First model (Borers’) performed the worst, based on Silhouette
and calinski-harabaz scores. (figure 11) Clusters had smaller
average distance from each other, despite the fact that there
were huge differences in some characteristics, such as
aggression. (figure 5) Clustering in second model resulted in
very different levels in competitiveness (wtshwd) and
profitability. Worst cluster had 15% winning players, while
best one – 33%. Worst cluster had highest levels of
competitiveness (wtshwd) and opportunism (commprop).
(0.23; 0.035) Third model performed average between
remaining two, just with less distinction in profitability.
Optimal number of clusters was found to be 4, using silhouette
(figure 3) and elbow plots. To sum up, Borer’s variables did
not hold up as distinctly unique and significant, in player style
clustering

Attempt to uncover characteristics of a winning poker player was
marginally successful. Distribution graphs of winners, revealed
unexpectedly large frequencies for small magnitudes of
COMMPROP. Random Forest was able to predict winners/losers
class with 75% cross-validated accuracy. However, it was much
more successful in recalling losers than winners (0.95 and 0.48).
GINI importance measure revealed COMMPROP significance, at
value of 0.41, while second most important measure Handn_Players
stood at 0.17. Contributions were close to 0, meaning that variables
influenced probability non-linearly. Positive effects of certain values,
were canceled out by negative effects of other ones; or the effects
were non-deterministic. Graphing feature contributions, next to
actual values and splitting by bellow/above average, revealed certain
marginal differences. (figure 10) It also firmly confirmed, the
negative relationship between opportunism (COMMPROP) and
profitability.
